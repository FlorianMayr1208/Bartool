# Copilot Instructions for BarTool

## Project Overview
BarTool is a bar management system with a FastAPI backend and a React + TypeScript frontend. It is designed for lightweight, local operation (e.g., Raspberry Pi) and uses SQLite for storage. The architecture is split into clear service boundaries: backend (API, DB, services) and frontend (UI, API client).

## Key Components & Structure
- **Backend (`backend/app/`)**
  - `main.py`: FastAPI entry point, CORS, error middleware, `/healthz` route.
  - `api/`: API endpoints (e.g., `recipes.py`, `inventory.py`, `barcode.py`).
  - `db/`: SQLAlchemy models (`models.py`), Pydantic schemas (`schemas.py`), CRUD logic (`crud.py`), DB session helper (`session.py`).
  - `services/`: Integrations (e.g., barcode lookup, external recipe DB).
  - `data/seed.sqlite`: Default DB, seeded via `seed_db.py`.
- **Frontend (`frontend/src/`)**
  - `pages/`: Main views (e.g., `Recipes.tsx`, `Inventory.tsx`).
  - `components/`: Reusable UI elements.
  - `api.ts`: API client, fetches from backend using `VITE_API_BASE`.

## Developer Workflows
- **Backend**
  - Install dependencies: `pip install -r requirements.txt`
  - Start server: `uvicorn backend.app.main:app --reload`
  - Seed DB: `python backend/app/db/seed_db.py`
- **Frontend**
  - Install dependencies: `npm install` (in `frontend/`)
  - Start dev server: `npm run dev`
  - API base URL: set in `frontend/.env` (`VITE_API_BASE`)

## Patterns & Conventions
- **API Design**: RESTful endpoints, OpenAPI docs auto-generated by FastAPI. Error handling via middleware in `main.py`.
- **Database**: SQLAlchemy models, many-to-many via association tables. Pydantic schemas for validation.
- **Frontend**: React functional components, hooks for state/data fetching. TypeScript interfaces for API data. Tailwind CSS for styling.
- **Barcode Lookup**: `/barcode/{EAN}` endpoint integrates with Open Food Facts.
- **Recipe Search/Save**: Frontend `Recipes.tsx` uses `searchRecipes` and `createRecipe` API calls. Saved recipes are filtered from search results.

## Integration Points
- **External APIs**: Barcode lookup (Open Food Facts), recipe import (CocktailDB).
- **Cross-component Communication**: Frontend fetches via `api.ts`, backend exposes REST endpoints.

## Testing & Quality
- **Backend**: Tests in `backend/tests/` using pytest + httpx. Aim for â‰¥80% coverage.
- **Frontend**: ESLint config in `frontend/eslint.config.js`. Type-aware linting recommended.

## Example: Adding a Recipe
1. Frontend calls `searchRecipes` (API `/recipes/search`).
2. User saves a recipe; frontend calls `createRecipe` (API `/recipes/`).
3. Backend fetches details from CocktailDB, creates DB entry, ensures inventory for ingredients.

## References
- See `README.md`, `structure.md`, and `technical_specification.md` for further details.
- For new endpoints, follow patterns in `backend/app/api/` and update schemas/models as needed.

---
**Feedback:** If any section is unclear or missing, please specify which workflows, patterns, or integration details need further documentation.
